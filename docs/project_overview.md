# Solana Weekly Lottery Application: Project Overview

## 1. Project Goal

The Solana Weekly Lottery application aims to create a decentralized, transparent, and fair weekly lottery system built on the Solana blockchain. Users can purchase tickets for a chance to win a portion of the prize pool, with a percentage of the pool also allocated to development fees.

## 2. Architecture Overview

The project consists of three main components:

*   **Solana Smart Contract (Program):** The core logic of the lottery, written in Rust using the Anchor framework. It manages lottery configuration, lottery rounds, ticket purchases, winner selection, and prize distribution.
*   **Frontend Application:** A web-based user interface, built with Next.js and TypeScript, allowing users to connect their Solana wallets, view lottery status, purchase tickets, and see results.
*   **Interaction Scripts:** TypeScript scripts used for administrative tasks such as deploying the smart contract, initializing its configuration, and starting new lottery rounds on the Devnet.

## 3. Technologies Used

### 3.1. Blockchain & Smart Contracts

*   **Solana:** The underlying high-performance blockchain platform chosen for its speed and low transaction fees, making it suitable for a high-frequency application like a lottery. All on-chain lottery logic and data are secured and processed by the Solana network.
*   **Rust:** The programming language used to write the Solana smart contract. Rust's performance and safety features are critical for developing secure and efficient on-chain programs.
*   **Anchor Framework:** A framework for rapidly building and testing Solana Sealevel programs (smart contracts). Anchor simplifies Solana smart contract development by providing a Rust eDSL (embedded domain-specific language), IDL generation, client generation, and testing utilities. Our smart contract (`solana_lottery_contract`) is built using Anchor.
*   **Solana Program Library (SPL):** While not explicitly detailed as a direct dependency in the current contract, awareness of SPL is important for common Solana functionalities like token interactions if the lottery were to expand to use SPL tokens for fees or prizes. For now, it primarily uses system program for SOL transfers.
*   **Solana CLI:** Command-line interface for interacting with the Solana network. Used for tasks like deploying the compiled smart contract to Devnet, airdropping SOL to test wallets, and potentially for direct on-chain data queries or administrative contract calls if needed.
*   **JSON IDL (Interface Definition Language):** Automatically generated by the Anchor framework when the smart contract is built. This JSON file (`solana_lottery_contract.json`) describes the contract's instructions, accounts, and data types, enabling client-side applications (frontend and scripts) to interact with the contract in a structured way.

### 3.2. Frontend Development

*   **Next.js:** A React framework used to build the user interface of the lottery application. Chosen for its features like server-side rendering (SSR) or static site generation (SSG), routing, and overall developer experience, leading to a performant and maintainable web application.
*   **React:** A JavaScript library for building user interfaces. Next.js uses React to create interactive and dynamic components for the lottery application, such as displaying lottery status, ticket purchase forms, and results.
*   **TypeScript:** A superset of JavaScript that adds static typing. Used extensively in both the Next.js frontend (`/home/ubuntu/solana_lottery_app/frontend/solana_lottery_frontend`) and the administrative/testing scripts (`/home/ubuntu/solana_lottery_app/smart_contract/solana_lottery_contract/tests/`) to improve code quality, catch errors early, and enhance developer productivity.
*   **@solana/wallet-adapter-react:** A suite of React hooks and components that simplify the integration of Solana wallets (like Phantom, Solflare, etc.) into the Next.js frontend. It handles wallet connection, public key retrieval, and transaction signing requests.
*   **@coral-xyz/anchor (formerly @project-serum/anchor):** The JavaScript/TypeScript client library for interacting with Anchor-based Solana programs. This library is used in the frontend (`solanaLotteryHooks.ts`) and in our Devnet interaction scripts to call smart contract instructions (e.g., `initializeConfig`, `startNewLotteryRound`, `enterLottery`) and fetch on-chain data.
*   **HTML/CSS:** Standard web technologies. HTML is used for structuring the content of the web pages, and CSS (likely via Next.js's built-in support or a CSS-in-JS solution/utility classes if added) is used for styling the user interface to create a visually appealing experience.

### 3.3. Scripting, Testing & Deployment

*   **Node.js:** A JavaScript runtime environment. It's essential for the frontend development toolchain (Next.js, npm/yarn) and for running our TypeScript-based administrative and testing scripts (e.g., `devnet_initialize_config.ts`, `devnet_start_round.ts`).
*   **ts-node:** A TypeScript execution engine and REPL for Node.js. Used to directly execute TypeScript scripts for smart contract testing and administrative tasks without needing a separate pre-compilation step to JavaScript.
*   **Mocha:** A JavaScript test framework. Anchor uses Mocha by default for its integrated testing environment (`anchor test`). The tests in `/home/ubuntu/solana_lottery_app/smart_contract/solana_lottery_contract/tests/solana_lottery_contract.ts` are written to be run with Mocha.
*   **Chai:** An assertion library commonly used with Mocha. It provides expressive syntax for writing test assertions to verify that the smart contract behaves as expected (e.g., `assert.ok(...)`, `assert.strictEqual(...)`).

### 3.4. Version Control & General Tooling

*   **Git:** Distributed version control system. Used to track changes to the codebase, manage different versions, and facilitate collaboration among developers (though not explicitly managed by the AI agent, it's a standard assumption for such projects).
*   **npm / yarn:** Package managers for Node.js. Used to install and manage project dependencies for the frontend application and the TypeScript scripting environment (e.g., Anchor client, wallet adapter, Next.js itself).
*   **Shell (Bash/Linux):** The command-line interface used within the sandbox environment to execute various commands for building the contract (`anchor build`), running scripts (`ts-node ...`), managing files, and interacting with the Solana CLI.

## 4. Key Project Files and Structure

The project is organized into several key directories and files:

*   **/home/ubuntu/solana_lottery_app/smart_contract/solana_lottery_contract/**: Contains the Solana smart contract developed using the Anchor framework.
    *   `programs/solana_lottery_contract/src/lib.rs`: The core Rust source code for the smart contract logic.
    *   `Anchor.toml`: Configuration file for the Anchor project.
    *   `target/idl/solana_lottery_contract.json`: The Interface Definition Language (IDL) file generated by Anchor, describing the smart contract's interface. This is crucial for client-side interaction.
    *   `tests/solana_lottery_contract.ts`: The primary TypeScript test file for the smart contract, using Mocha and Chai, run via `anchor test`.
    *   `tests/devnet_initialize_config.ts`: A TypeScript script used to initialize the `LotteryConfig` account on the Devnet.
    *   `tests/devnet_start_round.ts`: A TypeScript script used to start a new lottery round on the Devnet.

*   **/home/ubuntu/solana_lottery_app/frontend/solana_lottery_frontend/**: Contains the Next.js frontend application.
    *   `src/app/page.tsx`: The main page component for the lottery application.
    *   `src/lib/solanaLotteryHooks.ts`: Custom React hooks in TypeScript for interacting with the Solana smart contract from the frontend.
    *   `src/lib/mockData.ts`: Currently holds mock data for UI development; will be replaced with live contract data.
    *   `package.json`: Defines frontend project dependencies and scripts.

*   **/home/ubuntu/solana_lottery_app/rust_init_client/**: Contains an alternative Rust client for contract initialization (explored during development, less central to current Devnet interaction strategy).

*   **Project Management & Documentation (in /home/ubuntu/):**
    *   `project_log.md`: A log of project activities and decisions.
    *   `todo.md`: A checklist of tasks, aligned with sprint plans.
    *   `sprint[X]_plan.md` (e.g., `sprint3_plan.md`): Detailed plans for each development sprint.
    *   `dev_log_[developer]_sprint[X].md` (e.g., `dev_log_alice_sprint3.md`): Individual developer logs tracking progress and challenges.
    *   `project_overview.md`: This document.

## 5. Current Status (as of May 11, 2025)

The project is currently in **Sprint 3**. Key highlights of the current status include:

*   **Smart Contract Initialization on Devnet:** The `LotteryConfig` account for the smart contract has been successfully initialized on the Solana Devnet. This was achieved by adapting the Anchor test framework scripts (`devnet_initialize_config.ts`) after encountering challenges with direct Solana CLI-based initialization methods.
*   **Smart Contract Functionality Development:**
    *   The `initialize_config` instruction is confirmed working on Devnet.
    *   Work is underway to implement and test the `start_new_lottery_round` instruction on Devnet using a similar script-based approach (`devnet_start_round.ts`).
    *   Subsequent contract functionalities (e.g., `enter_lottery`, `pick_winner`, `distribute_prizes`) will be tested on Devnet.
*   **Frontend Development:**
    *   Basic frontend structure is in place using Next.js and TypeScript.
    *   Hooks for smart contract interaction (`solanaLotteryHooks.ts`) have been partially developed and are being updated to connect to the Devnet-deployed contract.
    *   Integration with live contract data from Devnet is a primary goal for the current and upcoming frontend tasks.
*   **Challenges & Learnings:**
    *   Initial difficulties with smart contract initialization on Devnet led to a shift in strategy towards using Anchor's testing/scripting capabilities for Devnet interactions, which proved successful.
    *   The importance of robust Devnet testing scripts for administrative functions has been highlighted.

## 6. How to Get Started (For New Developers)

Welcome to the Solana Weekly Lottery project! Hereâ€™s how you can get your development environment set up and start contributing:

### 6.1. Prerequisites
*   **Core Knowledge:** Familiarity with blockchain concepts, particularly Solana. Proficiency in Rust (for smart contracts) and TypeScript (for frontend and scripts). Experience with the Anchor framework, Next.js, and React is highly beneficial.
*   **Software:**
    *   Solana CLI: [Install Guide](https://docs.solana.com/cli/install-solana-cli-tools)
    *   Rust & Cargo: [Install Guide](https://www.rust-lang.org/tools/install)
    *   Anchor Framework: [Install Guide](https://www.anchor-lang.com/docs/installation) (Ensure Anchor version compatibility with the project).
    *   Node.js (which includes npm): [Install Guide](https://nodejs.org/en/download/)
    *   Yarn (optional, but used in frontend): [Install Guide](https://classic.yarnpkg.com/en/docs/install)

### 6.2. Project Setup
1.  **Clone Repository:** (Assuming the project is hosted in a Git repository. If working within this environment, the files are at `/home/ubuntu/solana_lottery_app/`).
2.  **Smart Contract Setup:**
    *   Navigate to the smart contract directory: `cd /home/ubuntu/solana_lottery_app/smart_contract/solana_lottery_contract/`
    *   Install dependencies (if any, though Anchor usually manages Rust crates): `anchor build` often handles this.
    *   Build the contract: `anchor build`. This will compile the Rust code and generate/update the IDL in `target/idl/solana_lottery_contract.json`.
    *   (Optional) Run local tests: `anchor test`.
3.  **Frontend Setup:**
    *   Navigate to the frontend directory: `cd /home/ubuntu/solana_lottery_app/frontend/solana_lottery_frontend/`
    *   Install dependencies: `yarn install` (or `npm install` if you prefer npm and update `yarn.lock` accordingly).
    *   Start the development server: `yarn dev` (or `npm run dev`). The application should be accessible at `http://localhost:3000`.

### 6.3. Key Areas to Understand
*   **Smart Contract (`programs/solana_lottery_contract/src/lib.rs`):** This is the heart of the lottery logic. Understand the data structures (accounts) and instruction handlers.
*   **Frontend Interaction (`src/lib/solanaLotteryHooks.ts`):** These hooks bridge the Next.js UI with the Solana smart contract using `@coral-xyz/anchor` and `@solana/wallet-adapter-react`.
*   **Devnet Scripts (`tests/devnet_*.ts`):** These scripts are crucial for deploying, initializing, and managing the lottery on Devnet. They serve as excellent examples of how to interact with the contract programmatically.
*   **Anchor IDL (`target/idl/solana_lottery_contract.json`):** Essential for understanding the contract's API from the client-side.

### 6.4. Development Workflow
*   **Smart Contract Changes:**
    1.  Modify Rust code in `programs/solana_lottery_contract/src/lib.rs`.
    2.  Run `anchor build` to compile and update the IDL.
    3.  If deploying to a local validator or Devnet: `anchor deploy --provider.cluster <local/devnet>`.
    4.  Update the IDL file in the frontend if it's not automatically linked (e.g., copy `target/idl/solana_lottery_contract.json` to a location accessible by the frontend).
    5.  Test changes using `anchor test` or custom Devnet scripts.
*   **Frontend Changes:**
    1.  Modify TypeScript/React components in `/home/ubuntu/solana_lottery_app/frontend/solana_lottery_frontend/src/`.
    2.  The Next.js development server (`yarn dev`) usually provides hot reloading.
    3.  Test UI and interactions in the browser.
*   **Branching & Merging:** (Follow standard Git practices if a repository is in use).

### 6.5. Environment Configuration
*   **Solana Cluster:** Ensure your Solana CLI is configured to the correct cluster (local, Devnet, or mainnet-beta) using `solana config set --url <URL>`. Public Devnet RPC: `https://api.devnet.solana.com`.
*   **Wallet:** Have a Solana wallet (e.g., Phantom, Solflare) with Devnet SOL for testing transactions. The admin/payer keypair for scripts is typically configured within the scripts or environment variables.

## 7. Official Documentation and Resources

This section provides links to the official documentation for the key technologies and tools used in this project. It is highly recommended that new developers familiarize themselves with these resources.

### 7.1. Solana Ecosystem
*   **Solana:**
    *   Main Documentation: [https://solana.com/docs](https://solana.com/docs)
    *   Developer Portal: [https://solana.com/developers](https://solana.com/developers)
    *   Solana Cookbook (Recipes & Examples): [https://solana.com/developers/cookbook](https://solana.com/developers/cookbook)
    *   Solana CLI: (Covered in main Solana documentation)
*   **Anchor Framework:**
    *   Main Documentation: [https://www.anchor-lang.com/](https://www.anchor-lang.com/)
    *   GitHub Repository (includes examples): [https://github.com/solana-foundation/anchor](https://github.com/solana-foundation/anchor)
    *   Anchor (JS/TS Client Library): (Covered in Anchor documentation)
*   **Solana Wallet Adapter:**
    *   npm Package: [https://www.npmjs.com/package/@solana/wallet-adapter-react](https://www.npmjs.com/package/@solana/wallet-adapter-react)
    *   GitHub Repository: [https://github.com/anza-xyz/wallet-adapter](https://github.com/anza-xyz/wallet-adapter)

### 7.2. Programming Languages
*   **Rust (for Smart Contract):**
    *   Learn Rust: [https://www.rust-lang.org/learn](https://www.rust-lang.org/learn)
    *   The Rust Programming Language Book: [https://doc.rust-lang.org/book/](https://doc.rust-lang.org/book/)
*   **TypeScript (for Frontend & Scripts):**
    *   Main Documentation: [https://www.typescriptlang.org/docs/](https://www.typescriptlang.org/docs/)

### 7.3. Frontend Development
*   **Next.js:**
    *   Main Documentation: [https://nextjs.org/docs](https://nextjs.org/docs)
    *   Learn Next.js: [https://nextjs.org/learn](https://nextjs.org/learn)
*   **React:**
    *   Main Documentation (New): [https://react.dev/](https://react.dev/)
    *   Legacy Documentation: [https://legacy.reactjs.org/](https://legacy.reactjs.org/)
*   **HTML:**
    *   MDN Web Docs: [https://developer.mozilla.org/en-US/docs/Web/HTML](https://developer.mozilla.org/en-US/docs/Web/HTML)
*   **CSS:**
    *   MDN Web Docs: [https://developer.mozilla.org/en-US/docs/Web/CSS](https://developer.mozilla.org/en-US/docs/Web/CSS)

### 7.4. Scripting, Testing & General Tooling
*   **Node.js:**
    *   Main Documentation: [https://nodejs.org/en/docs/](https://nodejs.org/en/docs/)
    *   API Reference: [https://nodejs.org/api/](https://nodejs.org/api/)
*   **ts-node:**
    *   npm Package: [https://www.npmjs.com/package/ts-node](https://www.npmjs.com/package/ts-node)
    *   Official Docs: [https://typestrong.org/ts-node/](https://typestrong.org/ts-node/)
*   **Mocha (Test Framework):**
    *   Main Documentation: [https://mochajs.org/](https://mochajs.org/)
*   **Chai (Assertion Library):**
    *   Main Documentation: [https://www.chaijs.com/](https://www.chaijs.com/)
*   **Git (Version Control):**
    *   Main Documentation: [https://git-scm.com/doc](https://git-scm.com/doc)
*   **npm (Package Manager):**
    *   Main Documentation: [https://docs.npmjs.com/](https://docs.npmjs.com/)
*   **Yarn (Package Manager):**
    *   Main Documentation: [https://yarnpkg.com/](https://yarnpkg.com/)

